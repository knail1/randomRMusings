# clear variables
rm(list=ls())

# set working directory
setwd("/Users/gregorytrautman/Greg Learning/ISYE 6501 Homework 4")

#library for Information Value
library(InformationValue)

german_data <-read.table("german.data.txt")

#convert the response value from 1 and 2 to 0 and 1

german_data$V21[german_data$V21==1] <- 0
german_data$V21[german_data$V21==2] <- 1

#logistic regression

logreg <- glm(V21 ~ .,family = binomial(link = "logit"), data = german_data)

predictions <- predict(logreg,data = german_data[,1:20], type = "response")

predictions <- predictions + .3

predictions <- round(predictions) 

c_mat <- confusionMatrix(predictions,german_data$V21)

cost = c_mat[2,1] * 5 + c_mat [1,2]

c_mat
cost

